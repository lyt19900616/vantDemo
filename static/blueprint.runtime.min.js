!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.BluePrint=t():e.BluePrint=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=14)}([function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=function(){function e(){}return e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=function(){function e(){}return e.createGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},e.IsEmptyObject=function(e){if(null==e)return!1;if(e instanceof Array)return!1;for(var t in e)return!1;return!0},e.GetResourceId=function(e){if(null==e)return null;var t=e.substring(3);t=t.substr(0,t.length-1);var r=t.split("|");return null==r||0==r.length?null:r[0]},e.getQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),r=window.location.search.substr(1).match(t);return null!=r?r[2]:null},e.getControlIcon=function(e){return"assets/icons/"+e+".png"},e.IsWeiXin=function(){if(null===e._isWeiXin){var t=navigator.userAgent.toLowerCase();e._isWeiXin=t.indexOf("micromessenger")>0}return e._isWeiXin},e.DownloadFile=function(e){if(null!=e)try{var t=document.createElement("iframe");return t.src=e,t.style.display="none",document.body.appendChild(t),Promise.resolve(!0)}catch(e){console.error("download file failed! "+e)}return Promise.resolve(!1)},e.VersionCompare=function(e,t){if(e||(e="0.0.0"),t||(t="0.0.0"),e==t)return 0;for(var r=e.split("."),n=t.split("."),o=Math.min(r.length,n.length),i=0;i<o;i++){var s=parseInt(r[i]),u=parseInt(n[i]);if(s>u)return 1;if(s<u)return-1}return r.length>n.length?1:r.length<n.length?-1:0},e.DeprecatedFunctionWarning=function(e,t,r){var n="("+e+") is deprecated in version ("+r+") and will be removed in the next major release. Use ("+t+") instead.";console.warn(n)},e}();n._isWeiXin=null},function(e,t,r){"use strict";(function(e){var r="undefined"!=typeof window&&window,n="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,o=void 0!==e&&e,i=r||o||n;t.root=i,function(){if(!i)throw new Error("RxJS could not find any global context (window, self, global)")}()}).call(t,r(31))},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=function(){function e(e,t,r){if(e)this.resourceId=e,this.url=t,this.url&&(this.fileName=t.slice(t.lastIndexOf("/")+1)),this.expression=r||(this.fileName?"[f$"+e+"|"+this.fileName+"]":"[f$"+e+"]");else if(t){this.url=t;var n=t.lastIndexOf("/");if(this.fileName=t.slice(n+1),this.fileName.startsWith("file?resourceId="))this.resourceId=this.fileName.slice(this.fileName.lastIndexOf("=")+1);else{var o=n>0?t.slice(t.lastIndexOf("/",n-1)+1,n):"";if(o.length<30||0==o.length){var i=this.fileName.indexOf("."),s=i>=0?this.fileName.slice(0,i):this.fileName;this.resourceId=s}else this.resourceId=o}this.expression="[f$"+this.resourceId+"|"+this.fileName+"]"}else if(r){var u=/\[f\$(.+?)\|(.+?)\]/i,c=u.exec(r);this.expression=c[0],this.resourceId=c[1]}}return Object.defineProperty(e.prototype,"file",{get:function(){return this._file},set:function(e){var t=this;this._file=e,this.fileName=e.name,this.url=this._file.value,this.size=this._file.size;var r=new FileReader;r.onload=function(){t.url=r.result},r.readAsDataURL(this._file)},enumerable:!0,configurable:!0}),e.prototype.IsWeixinResource=function(){var e=this.url;return e&&(e.startsWith("wxLocalResource://")||e.startsWith("weixin://resourceid"))},e.FileWithExpression=function(e){var t=this.FilesWithExpression(e);return t?t[0]:null},e.FilesWithExpression=function(t){for(var r,n=/\[f\$(.+?)\]/gi,o=[];r=n.exec(t);){var i=r[0],s=r[1].split("|"),u=s[0],c=new e(u,null,i);if(s[1]){var a=s[1];c.fileName=a}o.push(c)}return o},e.FileWithUrl=function(t){return new e(null,t,null)},e.ExpressionWithFileOrList=function(e){return e instanceof Array?e.map(function(e,t,r){return e.expression}).join():e.expression},e.GetFiles=function(e){return e instanceof Array?e.map(function(e,t,r){return e.file}):e.file},e.FilePathToNativeFile=function(e){var t=this;return e.map(function(e,r,n){return t.FileWithUrl(e)})},e.wrapFileListResult=function(e,t){e.nativeFiles=this.FilePathToNativeFile(t)},e.wrapFileResult=function(e,t){if(t){e.nativeFile=this.FileWithUrl(t)}},e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=function(){function e(e){this.OperateCode=e.OperateCode,this.Content=e}return e}()},function(e,t,r){"use strict";function n(){return o}t.a=n;var o=null},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=function(){function e(){}return e.prototype.GetDomainUserId=function(){return null!=this.domain&&""!=this.domain||(this.domain=e.GetDomain(this.userId)),e.GetDomainUserId(this.userId,this.domain)},e.GetDomainUserId=function(e,t){return e+"@"+t},e.GetDomain=function(e){return e.split("@")[1]},e.prototype.getRoleTagsOfStringList=function(){return this.roleTags?this.roleTags.map(function(e){return e.name}):[]},e.GetDepartment=function(e){var t=e.split("-");return t[t.length-1]},e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=function(){function e(e,t){this._message=e,this._error=t}return Object.defineProperty(e.prototype,"Success",{get:function(){return null==this._error},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Error",{get:function(){return this._error},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Message",{get:function(){return this._message},enumerable:!0,configurable:!0}),e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(0),o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(e){function t(){var t=e.call(this)||this;return t.OperateCode=3110,t}return o(t,e),t}(n.a)},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(0),o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(e){function t(){var t=e.call(this)||this;return t.OperateCode=3111,t}return o(t,e),t}(n.a)},function(e,t,r){"use strict";function n(e){return"function"==typeof e}t.isFunction=n},function(e,t,r){"use strict";t.errorObject={e:{}}},function(e,t,r){"use strict";t.empty={closed:!0,next:function(e){},error:function(e){throw e},complete:function(){}}},function(e,t,r){"use strict";var n=r(2),o=n.root.Symbol;t.rxSubscriber="function"==typeof o&&"function"==typeof o.for?o.for("rxSubscriber"):"@@rxSubscriber",t.$$rxSubscriber=t.rxSubscriber},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"RuntimeService",function(){return o});var n=r(15),o=new n.a},function(e,t,r){"use strict";r.d(t,"a",function(){return f});var n=r(16),o=r(19),i=r(26),s=r(27),u=r(28),c=r(41),a=r(42),l=r(47),p=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),f=function(e){function t(){var t=e.call(this)||this,r=new l.a;return t.HttpTransferService=new u.a(r,t.HostInfoService),t.MessageService=new n.a(t.HostInfoService,t.NativeService,t.HttpTransferService),t.ScriptService=new i.a,t.WeiXinService=new s.a(t.HostInfoService,t.HttpTransferService,t.ScriptService),t.UserService=new c.a(t.DebugService,t.HostInfoService),t.webDrivers=new a.a(t.DriverHub,t.NativeService,t.HostInfoService,t.UserService,t.HttpTransferService,t.DebugService),t}return p(t,e),t}(o.a)},function(e,t,r){"use strict";r.d(t,"a",function(){return l});var n=r(17),o=r(18),i=r(4),s=r(1),u=r(5),c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,u)}c((n=n.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(s=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,i=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(s=c.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){c.label=r[1];break}if(6===r[0]&&c.label<s[1]){c.label=s[1],s=r;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(r);break}s[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],i=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,s,u,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u},l=function(){function e(e,t,r){this.hostInfoService=e,this._nativeService=t,this.transferService=r,this.resourceFileUrl="/api/resource/file",this.isInQuery=!1,this.logoutUrl="/api/Account/Logout"}return e.prototype.Initialize=function(e){this.appId=e},e.prototype.Send=function(e){return this._nativeService.sendMessage(e)},e.prototype.RequestAppService=function(e,t,r){return c(this,void 0,void 0,function(){var o,i,s;return a(this,function(u){switch(u.label){case 0:return o=new n.a,o.appId=this.appId,o.domain=this.hostInfoService.domain,o.params=JSON.stringify(e),o.func=t,o.execType=r,[4,this.Send(o)];case 1:return i=u.sent(),0==i.Success?[2,Promise.reject(i.Error)]:(s=i.Message,[2,Promise.resolve(s.result)])}})})},e.prototype.ResourceFile=function(e){return this.transferService.baseUrl+this.resourceFileUrl+"?resourceId="+e},e.prototype.Post=function(e,t){return this.transferService.post(e,t)},e.prototype.Get=function(e){return this.transferService.get(e)},e.prototype.Import=function(e){return c(this,void 0,void 0,function(){var t,r,n,o;return a(this,function(i){switch(i.label){case 0:return s.a.DeprecatedFunctionWarning("Import","ImportExcelAsync","2.10"),[4,this.openFileChoose()];case 1:if(t=i.sent(),0==t.length)return[2];e.queryStart("正在导入"),r=null,i.label=2;case 2:return i.trys.push([2,4,5,6]),[4,this.ImportExcelAsync({domain:e.domain,appId:e.appId,modelId:e.modelId,file:t[0]})];case 3:return n=i.sent(),r=1==n?"导入成功":"导入失败",[3,6];case 4:return o=i.sent(),r="导入失败",[3,6];case 5:return e.queryEnd(),null!=r&&this.ShowErrorMessage(r),[7];case 6:return[2]}})})},e.prototype.ImportExcelAsync=function(e){return c(this,void 0,void 0,function(){var t,r,n,i,s;return a(this,function(u){switch(u.label){case 0:return t="/api/file/Import",r=new FormData,n=new o.a,n.domain=e.domain,n.appId=e.appId,n.modelId=e.modelId,r.append("message",JSON.stringify(n)),r.append("file",e.file),[4,this.Post(t,r)];case 1:return i=u.sent(),s=JSON.parse(i.text()),[2,this.QueryImportAsync(s.id)]}})})},e.prototype.QueryImportAsync=function(e){return c(this,void 0,void 0,function(){var t;return a(this,function(r){return t="/api/file/QueryImport",[2,this.QueryStatusUntilEndAsync(t,e)]})})},e.prototype.ShowErrorMessage=function(e){console.error(e),alert(e)},e.prototype.openFileChoose=function(){return new Promise(function(e,t){var r=document.createElement("input");r.type="file";document.body.appendChild(r),r.onchange=function(t){for(var n=[],o=0;o<r.files.length&&o<1;o++)n[o]=r.files[o];e(n),document.body.removeChild(r)},r.click()})},e.prototype.Export=function(e){return c(this,void 0,void 0,function(){var t,r,n;return a(this,function(o){switch(o.label){case 0:s.a.DeprecatedFunctionWarning("Export","ExportExcelAsync","2.10"),e.queryStart("正在导出"),t=null,o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,this.ExportExcelAsync({webArgs:e.webArgs,infoColumns:e.infoColumns})];case 2:return r=o.sent(),t=1==r?"导出成功":"导出失败",[3,5];case 3:return n=o.sent(),t="导出失败",[3,5];case 4:return e.queryEnd(),null!=t&&this.ShowErrorMessage(t),[7];case 5:return[2]}})})},e.prototype.ExportExcelAsync=function(e){return c(this,void 0,void 0,function(){var t,r,n,o,s,u,c,l;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),t="/api/file/export",r=e.webArgs,n=e.infoColumns,o=new i.a({message:r,infoColumns:n}),[4,this.Post(t,o)];case 1:return s=a.sent(),u=JSON.parse(s.text()),[4,this.QueryExportAsync(u.id)];case 2:return c=a.sent(),1==c?(this.Download(u.id),[2,Promise.resolve(!0)]):[2,Promise.resolve(!1)];case 3:return l=a.sent(),[2,Promise.reject(l)];case 4:return[2]}})})},e.prototype.CustomExport=function(e){return c(this,void 0,void 0,function(){var t,r,n;return a(this,function(o){switch(o.label){case 0:s.a.DeprecatedFunctionWarning("CustomExport","ExportExcelWithTemplate","2.10"),null==e.startMessage&&(e.startMessage="正在导出"),null!=e.queryStart&&e.queryStart(e.startMessage),null==e.successMessage&&(e.successMessage="导出成功"),t=null,o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,this.CustomExportAsync({header:e.header,rows:e.rows,fileName:e.fileName,sheetName:e.sheetName})];case 2:return r=o.sent(),t=1==r?e.successMessage:"导出失败",[3,5];case 3:return n=o.sent(),t="导出失败",[3,5];case 4:return null!=e.queryEnd&&e.queryEnd(),null!=t&&this.ShowErrorMessage(t),[7];case 5:return[2]}})})},e.prototype.CustomExportAsync=function(e){return c(this,void 0,void 0,function(){var t,r,n,o,s,u;return a(this,function(c){switch(c.label){case 0:t="/api/file/customexport",r=new i.a({header:e.header,rows:e.rows,fileName:e.fileName,sheetName:e.sheetName}),c.label=1;case 1:return c.trys.push([1,4,,5]),[4,this.Post(t,r)];case 2:return n=c.sent(),o=JSON.parse(n.text()),[4,this.QueryExportAsync(o.id)];case 3:return s=c.sent(),1==s?(this.Download(o.id),[2,Promise.resolve(!0)]):[2,Promise.resolve(!1)];case 4:return u=c.sent(),[2,Promise.reject(u)];case 5:return[2]}})})},e.prototype.ExportExcelWithTemplate=function(e){return c(this,void 0,void 0,function(){var t,r,n,o,s,c;return a(this,function(a){switch(a.label){case 0:t="/api/file/customexport",r=new i.a({templateFile:e.templateFile,rows:e.rows,fileName:e.fileName,sheetName:e.sheetName,appId:Object(u.a)().AppId,appVersion:Object(u.a)().AppVersion}),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,this.Post(t,r)];case 2:return n=a.sent(),o=JSON.parse(n.text()),[4,this.QueryExportAsync(o.id)];case 3:return s=a.sent(),1==s?(this.Download(o.id),[2,Promise.resolve(!0)]):[2,Promise.resolve(!1)];case 4:return c=a.sent(),[2,Promise.reject(c)];case 5:return[2]}})})},e.prototype.QueryStatusUntilEndAsync=function(e,t){return c(this,void 0,void 0,function(){var r=this;return a(this,function(n){return this.isInQuery?[2,Promise.reject({error:"alrealdy in query processing"})]:(this.isInQuery=!0,[2,new Promise(function(n,o){r._intervalId=setInterval(function(){r.QueryStatusAsync({url:e,id:t}).then(function(e){if(1==e)return clearInterval(r._intervalId),r.isInQuery=!1,n(!0)}).catch(function(e){return clearInterval(r._intervalId),r.isInQuery=!1,o(e)})},3e3)})])})})},e.prototype.QueryStatusAsync=function(e){return c(this,void 0,void 0,function(){var t,r,n,o;return a(this,function(i){switch(i.label){case 0:return t=e.url+"?id="+e.id,[4,this.Get(t)];case 1:return r=i.sent(),n=JSON.parse(r.text()),o=n.isCompleted,n.error?[2,Promise.reject(n.error)]:o?[2,Promise.resolve(!0)]:[2,Promise.resolve(!1)]}})})},e.prototype.QueryExportAsync=function(e){return c(this,void 0,void 0,function(){var t;return a(this,function(r){return t="/api/file/QueryExport",[2,this.QueryStatusUntilEndAsync(t,e)]})})},e.prototype.Download=function(e){var t="/api/file/Download?id="+e;s.a.DownloadFile(this.transferService.baseUrl+t)},e.prototype.Navigate=function(e){window.location.href=this.transferService.baseUrl+e},e.prototype.LoginOut=function(e){var t=this;void 0===e&&(e="");var r=this.logoutUrl;""!=e&&null!=e&&(e=encodeURI(e),r+="?redirectUrl="+e),this.Get(r).then(function(e){t.GotoLoginPage()}).catch(function(e){t.GotoLoginPage()})},e.prototype.GotoLoginPage=function(){this.transferService.GotoLoginPage},e}();(function(){function e(){}})(),function(){function e(){}}(),function(){function e(){}}(),function(){function e(){}}()},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(0),o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(e){function t(){var t=e.call(this)||this;return t.OperateCode=101202,t}return o(t,e),t}(n.a)},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(0),o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(e){function t(){var t=e.call(this)||this;return t.OperateCode=3107,t}return o(t,e),t}(n.a)},function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r(20),o=r(21),i=r(22),s=r(23),u=r(24),c=r(25),a=function(){function e(){var e=window;this.HostInfoService=new n.a(e),this.DebugService=new o.a;var t=Object(u.a)(this.HostInfoService);this.hostHandlerService=new s.a(e,this.HostInfoService,t),this.DriverHub=new c.a,this.NativeService=new i.a(this.hostHandlerService,this.HostInfoService,this.DriverHub,this.DebugService)}return e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(6),o=r(5),i=function(){function e(e){this._win=e,this.InitializeTestLogin(),this.info&&this.info.appEnv&&!this.info.appEnv.domain&&this.info.user.userId&&(this.info.appEnv.domain=n.a.GetDomain(this.info.user.userId))}return e.prototype.InitializeTestLogin=function(){var e=this._win.host;if(null==e){var t=sessionStorage.getItem("hostInfo");null!=t&&(e=JSON.parse(t)),null!=e&&(e.webServerUrl=sessionStorage.getItem("webServerUrl")),null!=e&&(e.sessionId=+sessionStorage.getItem("sessionId")),this._win.host=e}},Object.defineProperty(e.prototype,"info",{get:function(){return this._win.host},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsHosting",{get:function(){return!(!this.info||!this.info.device)&&(null!=this.info.device.isMobile?this.info.device.isMobile:this.info.device.mobile)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsHostingInLXPC",{get:function(){return!(!this.info||!this.info.device)&&(this.info.device.isLanXinPC||null!=this._win.lxpc)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appId",{get:function(){return this.pureAppId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pureAppId",{get:function(){if(this.info&&this.info.appEnv){if(this.info.appEnv.pureAppId)return this.info.appEnv.pureAppId;if(this.info.appEnv.appId)return this.info.appEnv.appId.split("@")[0]}return Object(o.a)()?Object(o.a)().AppId:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appIdWithDomain",{get:function(){return this.info&&this.info.appEnv&&this.info.appEnv.appId?this.info.appEnv.appId:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"domain",{get:function(){return this.info&&this.info.appEnv&&this.info.appEnv.domain?this.info.appEnv.domain:null},enumerable:!0,configurable:!0}),e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=function(){function e(){this.IsShow=!0}return e.prototype.Info=function(e){console.log(e)},e.prototype.Error=function(e){console.error(e)},e.prototype.ShowMessage=function(e){console.error(e)},e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return l});var n=r(3),o=r(7),i=r(1),s=r(8),u=r(9),c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,u)}c((n=n.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(s=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,i=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(s=c.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){c.label=r[1];break}if(6===r[0]&&c.label<s[1]){c.label=s[1],s=r;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(r);break}s[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],i=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,s,u,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u},l=function(){function e(e,t,r,n){this._hostHandlerService=e,this._hostInfoService=t,this._driverHub=r,this._debugService=n,this.resourceFileUrl="/api/resource/file"}return e.prototype._checkAndCallHostDriver=function(e,t){var r=this._hostHandlerService.hostHandlers[e];return r?r(t):this._driverHub.callHandler(e,t)},e.prototype.getResourceUrl=function(e){var t=this;if(e.url)return Promise.resolve(e.url);var r=e.expression;return r&&r.startsWith("[f$host://")?Promise.resolve(null):this.fileExist({resourceId:e.resourceId}).then(function(r){return r.exist?r.url:t.downloadFile({resourceId:e.resourceId}).then(function(e){return e.file})}).catch(function(e){throw console.error("getResourceUrl failed"+e),e})},e.prototype.getResourceInfo=function(e){var t=new u.a;return t.external=!0,t.resourceId=e,this.sendMessage(t).then(function(e){return e.Message.result})},e.prototype.getResourceUrls=function(e){var t=this,r=e.map(function(e,r,n){return t.getResourceUrl(e)});return Promise.all(r)},e.prototype.UploadFileToServer=function(e){return c(this,void 0,void 0,function(){var t,r,n;return a(this,function(o){switch(o.label){case 0:return t={success:!1,resourceId:null},e.expression?t.resourceId=i.a.GetResourceId(e.expression):t.resourceId=i.a.createGuid(),r={behavior:{_data:{_modelId:"FileUpload",fileExpression:e.expression}},immediatelyCommit:!0},n=t,[4,this.uploadBehaviorData(r)];case 1:return n.success=o.sent(),[2,Promise.resolve(t)]}})})},e.prototype.data=function(e){return this._checkAndCallHostDriver("data",e.native)},e.prototype.wifiDeviceInfo=function(e){return this._checkAndCallHostDriver("wifiDeviceInfo",e)},e.prototype.chooseImage=function(e){return this._checkAndCallHostDriver("chooseImage",e).then(function(e){return n.a.wrapFileListResult(e,e.localIds),e})},e.prototype.previewImage=function(e){return this._checkAndCallHostDriver("previewImage",e).then(function(e){if(e&&e.remains)for(var t=e.remains,r=0;r<t.length;r++){var n=t[r];n.startsWith("file://")||(t[r]="file://"+n)}return e})},e.prototype.openVoiceRecorder=function(e){return this._checkAndCallHostDriver("openVoiceRecorder",e).then(function(e){return n.a.wrapFileListResult(e,e.urls),e})},e.prototype.openVoicePlayer=function(e){return this._checkAndCallHostDriver("openVoicePlayer",e)},e.prototype.recordVideo=function(e){return this._checkAndCallHostDriver("recordVideo",e).then(function(e){return n.a.wrapFileResult(e,e.url),e})},e.prototype.openVideo=function(e){return this._checkAndCallHostDriver("openVideo",e)},e.prototype.getLocation=function(e){return this._checkAndCallHostDriver("getLocation",e)},e.prototype.selectLocation=function(e){return this._checkAndCallHostDriver("selectLocation",e)},e.prototype.displayLocation=function(e){return this._checkAndCallHostDriver("displayLocation",e)},e.prototype.scanQRCode=function(e){return this._checkAndCallHostDriver("scanQRCode",e)},e.prototype.makeCode=function(e){return this._checkAndCallHostDriver("makeCode",e)},e.prototype.handWrite=function(e){return this._checkAndCallHostDriver("handWrite",e).then(function(e){return n.a.wrapFileResult(e,e.handWriteUrl),e})},e.prototype.ResourceFile=function(e){return this._hostInfoService.info.webServerUrl+this.resourceFileUrl+"?resourceId="+e},e.prototype.changeToArray=function(e){return null==e?[]:"string"==typeof e?[e]:e instanceof Array?e:[e]},e.prototype.userInfoFill=function(e){if(null!=e.mobile&&(e.telephone=e.mobile),null!=e.name&&(e.userName=e.name),null!=e.path&&(e.branchName=e.path),null!=e.userUniId&&(e.userId=e.userUniId),null!=e.headerUrl&&(e.photoResId=e.headerUrl,e.photoFileName=e.headerUrl,e.headerUrl=this.ResourceFile(e.headerUrl)),(null==e.department||0==e.department.length)&&null!=e.path){var t=e.path,r=t.lastIndexOf("-");r>=0&&(e.department=t.substr(r+1))}return e},e.prototype.getUserInfo=function(e){var t=this,r=[this._hostInfoService.info.user.userId],n=[],o=[],i=[];null!=e&&("string"==typeof e?r=this.changeToArray(e):(null!=e.userUniId&&(r=this.changeToArray(e.userUniId)),null!=e.mobile&&(n=this.changeToArray(e.mobile)),null!=e.serialNumber&&(o=this.changeToArray(e.serialNumber)),null!=e.extendId&&(i=this.changeToArray(e.extendId))));var u=new s.a;return u.userUniIds=r,u.mobiles=n,u.serialNumbers=o,u.extendIds=i,this.sendMessage(u).then(function(e){var r=e.Message;if(null!=r.result&&1==r.result.length){return t.userInfoFill(r.result[0])}if(null!=r.result&&r.result.length>=2){for(var n=[],o=0;o<r.result.length;o++)n.push(t.userInfoFill(r.result[o]));return n}return null}).catch(function(e){return t._debugService.ShowMessage(JSON.stringify(e)),null})},e.prototype.checkNFC=function(e){return this._checkAndCallHostDriver("checkNFC",e)},e.prototype.checkBlueTooth=function(e){return this._checkAndCallHostDriver("checkBlueTooth",e)},e.prototype.pickDate=function(e){return this._checkAndCallHostDriver("pickDate",e)},e.prototype.ajax=function(e){return this._checkAndCallHostDriver("ajax",e)},e.prototype.registerMenu=function(e){return this._checkAndCallHostDriver("registerMenu",e)},e.prototype.transferMess=function(e){return this._checkAndCallHostDriver("transferMess",e)},e.prototype.recombineNotify=function(e){return this._checkAndCallHostDriver("recombineNotify",e)},e.prototype.chooseReceiver=function(e){return this._checkAndCallHostDriver("chooseReceiver",e).then(function(e){var t=e.userInfoList;return t&&t.forEach(function(e){if(e.path){var t=e.path,r=t.split("-");e.department=r[r.length-1],e.branchPath=t}}),e})},e.prototype.exploreFile=function(e){var t=this;return this._checkAndCallHostDriver("exploreFile",e).then(function(e){return t.wrapExploreFileResult(e),e})},e.prototype.wrapExploreFileResult=function(e){if(e){var t=e,r=e.resId;if(r){var o=e.isHost,i=o?"[f$host://"+r+"|"+e.fileName+"]":"[f$"+r+"|"+e.fileName+"]";t.nativeFile=n.a.FileWithExpression(i)}else{var s=e.url;if(!s)return;t.nativeFile=n.a.FileWithUrl(s)}}},e.prototype.getAppSetting=function(e){return this._checkAndCallHostDriver("getAppSetting",e)},e.prototype.getExpressionValue=function(e){return this._checkAndCallHostDriver("getExpressionValue",e)},e.prototype.setExpressionValue=function(e){return this._checkAndCallHostDriver("setExpressionValue",e)},e.prototype.notifyInputEvent=function(e){return this._checkAndCallHostDriver("notifyInputEvent",e)},e.prototype.notifySizeChanged=function(e){return this._checkAndCallHostDriver("notifySizeChanged",e)},e.prototype.finish=function(e){return this._checkAndCallHostDriver("finish",e)},e.prototype.IO=function(e){return this._checkAndCallHostDriver("IO",e)},e.prototype.bpLog=function(e){return this._checkAndCallHostDriver("bpLog",e)},e.prototype.call=function(e){return this._checkAndCallHostDriver("call",e)},e.prototype.sendSMS=function(e){return this._checkAndCallHostDriver("sendSMS",e)},e.prototype.sendWX=function(e){return this._checkAndCallHostDriver("sendWX",e)},e.prototype.error=function(e){return this._checkAndCallHostDriver("error",e)},e.prototype.uploadBehaviorData=function(e){return this._checkAndCallHostDriver("uploadBehaviorData",e)},e.prototype.downloadFile=function(e){return this._checkAndCallHostDriver("downloadFile",e)},e.prototype.remoteData=function(e){return this._checkAndCallHostDriver("remoteData",e.native)},e.prototype.queryStatisticsData=function(e){return this._checkAndCallHostDriver("queryStatisticsData",e)},e.prototype.bpCloseWindow=function(e){return this._checkAndCallHostDriver("bpCloseWindow",e)},e.prototype.bpMaximizeWindow=function(e){return Promise.resolve(null)},e.prototype.bpMinimizeWindow=function(e){return Promise.resolve(null)},e.prototype.bpRestoreWindow=function(e){return Promise.resolve(null)},e.prototype.syncData=function(e){return this._checkAndCallHostDriver("syncData",e)},e.prototype.fileExist=function(e){return this._checkAndCallHostDriver("fileExist",e)},e.prototype.openCard=function(e){return this._checkAndCallHostDriver("openCard",e)},e.prototype.openFile=function(e){return this._checkAndCallHostDriver("openFile",e)},e.prototype.setStatusBar=function(e){return this._checkAndCallHostDriver("setStatusBar",e)},e.prototype.sendMessage=function(e){return this._checkAndCallHostDriver("sendMessage",{message:e}).then(function(e){return e instanceof o.a?e:new o.a(e,null)})},e.prototype.shareMessage=function(e){return this._checkAndCallHostDriver("shareMessage",e)},e.prototype.transferOrder=function(e){return this._checkAndCallHostDriver("transferOrder",e)},e.prototype.openFileChoose=function(e){return void 0===e&&(e=null),this._checkAndCallHostDriver("openFileChoose",e)},e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=function(){function e(e,t,r){if(this._win=e,this.hostInfo=t,this.fixHandlers={},r)for(var n=0,o=r;n<o.length;n++){var i=o[n];this.registerFixHandler(i)}this.hostServices=this.getHostServices(),this.fixHostServices(),this.buildHostHandlers()}return Object.defineProperty(e.prototype,"callHostHandler",{get:function(){return this._win.CallHostDriver},enumerable:!0,configurable:!0}),e.prototype.registerFixHandler=function(e){var t=e.handleName+e.version;e.hostName&&(t+=e.hostName),e.useWebService?this.fixHandlers[t]=function(e){return null}:this.fixHandlers[t]=e.fixHandler},e.prototype.getHostServices=function(){return this._win.hostServices?this._win.hostServices:this._win.GetHostServices?this._win.GetHostServices():null},e.prototype.fixHostServices=function(){if(!this.hostServices)if(this.hostInfo.IsHosting){var e=this._win.lt;if(!e)return{};var t=Object.getOwnPropertyNames(e),r={};t.forEach(function(t,n,o){var i=function(t,r,n,o){var i=Object.assign({},n,o);e[r].call(e,i)};r[t]=i}),this.hostServices={lt:r}}else if(this.hostInfo.IsHostingInLXPC){var n=this._win.lxpc;if(!n)return{};var o={bpCloseWindow:"closewnd",bpMaximizeWindow:"maxwnd",bpMinimizeWindow:"minwnd",bpRestoreWindow:"restorewnd"},t=Object.getOwnPropertyNames(n),i={};t.forEach(function(e,t,r){var s=function(e,t,r,i){var s=o[t]?o[t]:t,u=Object.assign({},r,i);n[s].call(n,u)};i[e]=s}),this.hostServices={lxpc:i}}},e.prototype.getFixHostLoadingOrder=function(){return[]},e.prototype.getFixHandler=function(e,t,r,n){var o,i=t+r;if(e){var s=i+e;o=this.fixHandlers[s]}return o||(o=this.fixHandlers[i]),o?o(n):n},e.prototype.buildHostHandlers=function(){this.hostHandlers={};var e={};if(this.hostServices&&Object.getOwnPropertyNames(this.hostServices).length){for(var t=Object.assign({},this.hostServices),r=this.getFixHostLoadingOrder(),n=[],o=0,i=r;o<i.length;o++){var s=i[o];t[s]&&(delete t[s],n.push(s))}n=Object.getOwnPropertyNames(t).concat(n);for(var u=0,c=n;u<c.length;u++){var s=c[u],a=this.hostServices[s];for(var l in a)e[l]=s}}var p=this;for(var l in e)!function(t){var r=e[t],n=p.hostServices[r],o=n[t],i="",s=t,u=p.callHostHandler;if("boolean"==typeof o||("string"==typeof o?s=o:"function"==typeof o?u=o:(s=o.driverName,i=o.version)),!u)return"continue";var c=function(e,t,n){return t||(t=s),n||(n=r),new Promise(function(r,o){u(n,t,e,{success:r,fail:o,cancel:o})})},a=p.getFixHandler(r,t,i,c);a&&(p.hostHandlers[t]=a)}(l)},e.prototype.registerLtnDriver=function(e,t){this._win.ltn||(this._win.ltn={}),this._win.ltn[e]=t},e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n=r(1),o=function(e){var t=[];if(e.info){var r=e.info.device.sdkVersion;n.a.VersionCompare(r,"3.0")<=0&&t.push({handleName:"sendMessage",version:"",useWebService:!0})}return t}},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=function(){function e(){this.driverMap={}}return e.prototype.register=function(e,t,r){this.driverMap[t]=r.bind(e)},e.prototype.callHandler=function(e,t){var r=this.driverMap[e];if(!r)return console.error("WebService can not handle '"+e+"' !"),Promise.resolve(!1);if("function"==typeof r)return r(t);throw"not function"},e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n=[{name:"default-amap",src:"https://webapi.amap.com/maps?v=1.3&key=4609827793d21147539dc2eb40009a14&plugin=AMap.Autocomplete,AMap.Geocoder"}],o=function(){function e(){var e=this;this.scripts={},n.forEach(function(t){e.scripts[t.name]={loaded:!1,src:t.src}})}return e.prototype.load=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=[];return t.forEach(function(t){return n.push(e.loadScript(t))}),Promise.all(n)},e.prototype.loadScript=function(e,t){var r=this;return new Promise(function(n,o){if(null==r.scripts[e]){if(null==t)return void o({script:e,loaded:!1,status:"script src is null"});r.scripts[e]={loaded:!1,src:t}}if(r.scripts[e].loaded)n({script:e,loaded:!0,status:"Already Loaded"});else{var i=document.createElement("script");i.type="text/javascript",i.src=r.scripts[e].src,i.readyState?i.onreadystatechange=function(){"loaded"!==i.readyState&&"complete"!==i.readyState||(i.onreadystatechange=null,r.scripts[e].loaded=!0,n({script:e,loaded:!0,status:"Loaded"}))}:i.onload=function(){r.scripts[e].loaded=!0,n({script:e,loaded:!0,status:"Loaded"})},i.onerror=function(t){return n({script:e,loaded:!1,status:"Loaded"})},document.getElementsByTagName("head")[0].appendChild(i)}})},e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,u)}c((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(s=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,i=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(s=c.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){c.label=r[1];break}if(6===r[0]&&c.label<s[1]){c.label=s[1],s=r;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(r);break}s[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],i=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,s,u,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u},i=function(){function e(e,t,r){this.hostInfoService=e,this.transferService=t,this.scriptService=r,this.sendUrl="/api/weixin/send",this.qrCodeUrl="/api/weixin/qrcode",this.jsSignUrl="/api/weixin/jssign",this.uploadImageUrl="/api/weixin/uploadimage"}return e.prototype.SendMsg=function(e,t,r,n,o){var i={appId:this.hostInfoService.pureAppId,wxAppId:e,data:{touser:t,template_id:r,url:n,data:o}};return this.transferService.post(this.sendUrl,i)},e.prototype.GetJsSign=function(e,t){var r={appId:this.hostInfoService.pureAppId,wxAppId:e,url:t};return this.transferService.post(this.jsSignUrl,r)},e.prototype.CreateQRCode=function(e,t,r){var n={appId:this.hostInfoService.pureAppId,wxAppId:e,data:{expire_seconds:null!=r?r:604800,action_name:"QR_STR_SCENE",action_info:{scene:{scene_str:t}}}};return this.transferService.post(this.qrCodeUrl,n)},e.prototype.UploadImage=function(e,t,r){var n=this,o=window.wx;return new Promise(function(e,t){o.uploadImage({localId:r.url,isShowProgressTips:0,success:function(t){e(t)},fail:function(e){t(e)}})}).then(function(r){var o=r.serverId,i={appId:n.hostInfoService.pureAppId,wxAppId:e,resourceId:t,mediaId:o};return n.transferService.post(n.uploadImageUrl,i)})},e.prototype.LoadWeiXinScript=function(e,t){return n(this,void 0,void 0,function(){var r,n,i,s,u;return o(this,function(o){switch(o.label){case 0:return r=window.location.href.split("#")[0],[4,this.GetJsSign(e,r)];case 1:return n=o.sent(),n.ok?(i=n.json(),s=void 0,"https:"!=window.location.protocol?[3,3]:[4,this.scriptService.loadScript("weixin","https://res.wx.qq.com/open/js/jweixin-1.2.0.js")]):[3,6];case 2:return s=o.sent(),[3,5];case 3:return[4,this.scriptService.loadScript("weixin","http://res.wx.qq.com/open/js/jweixin-1.2.0.js")];case 4:s=o.sent(),o.label=5;case 5:return s.loaded?(u=window.wx,[2,new Promise(function(r,n){u.config({debug:!0,appId:e,timestamp:i.timestamp,nonceStr:i.nonceStr,signature:i.signature,jsApiList:t}),u.ready(function(){r(!0)}),u.error(function(e){n(e)})})]):[2,Promise.resolve(!1)];case 6:return[2,Promise.resolve(!1)]}})})},e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return c});var n=r(7),o=r(4),i=r(29),s=(r.n(i),this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,u)}c((n=n.apply(e,t||[])).next())})}),u=this&&this.__generator||function(e,t){function r(e){return function(t){return n([e,t])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(s=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[0,s.value]),r[0]){case 0:case 1:s=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,i=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(s=c.trys,!(s=s.length>0&&s[s.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){c.label=r[1];break}if(6===r[0]&&c.label<s[1]){c.label=s[1],s=r;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(r);break}s[2]&&c.ops.pop(),c.trys.pop();continue}r=t.call(e,c)}catch(e){r=[6,e],i=0}finally{o=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,s,u,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return u={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u},c=function(){function e(e,t){this.http=e,this.hostInfo=t,this.apiUrl="/api/Message/Send"}return Object.defineProperty(e.prototype,"baseUrl",{get:function(){return this.hostInfo.info&&this.hostInfo.info.webServerUrl?this.hostInfo.info.webServerUrl:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.hostInfo.info&&this.hostInfo.info.sessionId?this.hostInfo.info.sessionId:0},enumerable:!0,configurable:!0}),e.prototype.send=function(e){return s(this,void 0,void 0,function(){var t,r,n,i;return u(this,function(s){switch(s.label){case 0:e.sessionId||(e.sessionId=this.sessionId),t=new o.a(e),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.http.post(this.baseUrl+this.apiUrl,t)];case 2:return r=s.sent(),n=JSON.parse(r.content),[2,this.Result(n,r.error)];case 3:return i=s.sent(),this.CheckIfUnauthorizedThenQuit(i),[2,this.Result(null,i)];case 4:return[2]}})})},e.prototype.post=function(e,t){var r=this;return this.http.post(this.baseUrl+e,t).catch(function(e){return r.CheckIfUnauthorizedThenQuit(e),Promise.reject(e)})},e.prototype.get=function(e){var t=this;return this.http.get(this.baseUrl+e).catch(function(e){return t.CheckIfUnauthorizedThenQuit(e),Promise.reject(e)})},e.prototype.Result=function(e,t){return Promise.resolve(new n.a(e,t))},e.prototype.CheckIfUnauthorizedThenQuit=function(e){null==e||401!=e.status&&403!=e.status||this.GotoLoginPage()},e.prototype.GotoLoginPage=function(){var e=this.hostInfo.info;return this.hostInfo.IsHostingInLXPC?void window.location.reload(!0):null!=e&&null!=e.user&&null!=e.user.cmcUserUniId?void(window.location.href=e.openUrl):void window.location.assign(this.baseUrl)},e}()},function(e,t,r){"use strict";var n=r(30),o=r(40);n.Observable.prototype.toPromise=o.toPromise},function(e,t,r){"use strict";var n=r(2),o=r(32),i=r(39),s=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n=this.operator,i=o.toSubscriber(e,t,r);if(n?n.call(i,this.source):i.add(this.source?this._subscribe(i):this._trySubscribe(i)),i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.syncErrorThrown=!0,e.syncErrorValue=t,e.error(t)}},e.prototype.forEach=function(e,t){var r=this;if(t||(n.root.Rx&&n.root.Rx.config&&n.root.Rx.config.Promise?t=n.root.Rx.config.Promise:n.root.Promise&&(t=n.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,n){var o;o=r.subscribe(function(t){if(o)try{e(t)}catch(e){n(e),o.unsubscribe()}else e(t)},n,t)})},e.prototype._subscribe=function(e){return this.source.subscribe(e)},e.prototype[i.observable]=function(){return this},e.create=function(t){return new e(t)},e}();t.Observable=s},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";function n(e,t,r){if(e){if(e instanceof o.Subscriber)return e;if(e[i.rxSubscriber])return e[i.rxSubscriber]()}return e||t||r?new o.Subscriber(e,t,r):new o.Subscriber(s.empty)}var o=r(33),i=r(13),s=r(12);t.toSubscriber=n},function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=r(10),i=r(34),s=r(12),u=r(13),c=function(e){function t(r,n,o){switch(e.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=s.empty;break;case 1:if(!r){this.destination=s.empty;break}if("object"==typeof r){r instanceof t?(this.destination=r,this.destination.add(this)):(this.syncErrorThrowable=!0,this.destination=new a(this,r));break}default:this.syncErrorThrowable=!0,this.destination=new a(this,r,n,o)}}return n(t,e),t.prototype[u.rxSubscriber]=function(){return this},t.create=function(e,r,n){var o=new t(e,r,n);return o.syncErrorThrowable=!1,o},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this,t=e._parent,r=e._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=r,this},t}(i.Subscription);t.Subscriber=c;var a=function(e){function t(t,r,n,i){e.call(this),this._parentSubscriber=t;var u,c=this;o.isFunction(r)?u=r:r&&(u=r.next,n=r.error,i=r.complete,r!==s.empty&&(c=Object.create(r),o.isFunction(c.unsubscribe)&&this.add(c.unsubscribe.bind(c)),c.unsubscribe=this.unsubscribe.bind(this))),this._context=c,this._next=u,this._error=n,this._complete=i}return n(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber;if(this._error)t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else{if(!t.syncErrorThrowable)throw this.unsubscribe(),e;t.syncErrorValue=e,t.syncErrorThrown=!0,this.unsubscribe()}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){throw this.unsubscribe(),e}},t.prototype.__tryOrSetError=function(e,t,r){try{t.call(this._context,r)}catch(t){return e.syncErrorValue=t,e.syncErrorThrown=!0,!0}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(c)},function(e,t,r){"use strict";function n(e){return e.reduce(function(e,t){return e.concat(t instanceof a.UnsubscriptionError?t.errors:t)},[])}var o=r(35),i=r(36),s=r(10),u=r(37),c=r(11),a=r(38),l=function(){function e(e){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var e,t=!1;if(!this.closed){var r=this,l=r._parent,p=r._parents,f=r._unsubscribe,h=r._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var d=-1,v=p?p.length:0;l;)l.remove(this),l=++d<v&&p[d]||null;if(s.isFunction(f)){var y=u.tryCatch(f).call(this);y===c.errorObject&&(t=!0,e=e||(c.errorObject.e instanceof a.UnsubscriptionError?n(c.errorObject.e.errors):[c.errorObject.e]))}if(o.isArray(h))for(d=-1,v=h.length;++d<v;){var b=h[d];if(i.isObject(b)){var y=u.tryCatch(b.unsubscribe).call(b);if(y===c.errorObject){t=!0,e=e||[];var m=c.errorObject.e;m instanceof a.UnsubscriptionError?e=e.concat(n(m.errors)):e.push(m)}}}if(t)throw new a.UnsubscriptionError(e)}},e.prototype.add=function(t){if(!t||t===e.EMPTY)return e.EMPTY;if(t===this)return this;var r=t;switch(typeof t){case"function":r=new e(t);case"object":if(r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if("function"!=typeof r._addParent){var n=r;r=new e,r._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(r),r._addParent(this),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},e.prototype._addParent=function(e){var t=this,r=t._parent,n=t._parents;r&&r!==e?n?-1===n.indexOf(e)&&n.push(e):this._parents=[e]:this._parent=e},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();t.Subscription=l},function(e,t,r){"use strict";t.isArray=Array.isArray||function(e){return e&&"number"==typeof e.length}},function(e,t,r){"use strict";function n(e){return null!=e&&"object"==typeof e}t.isObject=n},function(e,t,r){"use strict";function n(){try{return i.apply(this,arguments)}catch(e){return s.errorObject.e=e,s.errorObject}}function o(e){return i=e,n}var i,s=r(11);t.tryCatch=o},function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},o=function(e){function t(t){e.call(this),this.errors=t;var r=Error.call(this,t?t.length+" errors occurred during unsubscription:\n  "+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"");this.name=r.name="UnsubscriptionError",this.stack=r.stack,this.message=r.message}return n(t,e),t}(Error);t.UnsubscriptionError=o},function(e,t,r){"use strict";function n(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}var o=r(2);t.getSymbolObservable=n,t.observable=n(o.root),t.$$observable=t.observable},function(e,t,r){"use strict";function n(e){var t=this;if(e||(o.root.Rx&&o.root.Rx.config&&o.root.Rx.config.Promise?e=o.root.Rx.config.Promise:o.root.Promise&&(e=o.root.Promise)),!e)throw new Error("no Promise impl found");return new e(function(e,r){var n;t.subscribe(function(e){return n=e},function(e){return r(e)},function(){return e(n)})})}var o=r(2);t.toPromise=n},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(6),o=r(3),i=function(){function e(e,t){this.debugService=e,this.hostInfoService=t,this.systemDefaultSetting=[],this.Initialize()}return e.prototype.ContainsTag=function(e){if(null==this.UserInfo.roleTags)return!1;var t=!1;return this.UserInfo.roleTags.some(function(r){return r.name===e&&(t=!0),t}),t},e.prototype.Initialize=function(){var e=this.hostInfoService.info;if(null==e)return void this.debugService.Error("Can't find HostInfo on window.");if(this.UserInfo=e.user,null!=this.UserInfo){this.UserInfo.path&&(this.UserInfo.department=n.a.GetDepartment(this.UserInfo.path));var t=e.user.name;if(t&&(this.UserInfo.userName=t),this.UserInfo.roleTags=e.roleTags,this.UserInfo.headerUrl){var r=o.a.FileWithUrl(this.UserInfo.headerUrl);this.UserInfo.headerUrl=r.expression}null!=this.UserInfo.userId&&(this.UserInfo.domain=n.a.GetDomain(this.UserInfo.userId))}},e}()},function(e,t,r){"use strict";r.d(t,"a",function(){return f});var n=r(3),o=r(1),i=r(43),s=r(8),u=r(9),c=r(44),a=r(45),l=r(46),p=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),f=function(e){function t(t,r,n,o,i,s){var u=e.call(this,t)||this;return u._nativeNative=r,u._hostInfoService=n,u._userService=o,u._transferService=i,u._debugService=s,u._resourceFileUrl="/api/resource/file",u}return p(t,e),t.prototype.data=function(e){return this._queryData(e,!0)},t.prototype.remoteData=function(e){return null==e.querySql||""==e.querySql?this._queryData(e,!1):this._queryStatisticsData(e)},t.prototype._queryData=function(e,t){var r=e.web?e.web:e;return r.owner=t,this._nativeNative.sendMessage(r).then(function(e){var t={},r=e.Message;return t.data=r.result,t.total=r.total,t}).catch(function(e){})},t.prototype._queryStatisticsData=function(e){var t=new i.a;return t.domain=this._hostInfoService.domain,t.appId=this._hostInfoService.pureAppId,t.sql=e.querySql,this._nativeNative.sendMessage(t).then(function(e){var t={},r=e.Message;return t.duration=r.duration,t.data=r.data,t.state=r.state,t}).catch(function(e){console.error("queryStatisticsData: "+JSON.stringify(e))})},t.prototype._changeToArray=function(e){return null==e?[]:"string"==typeof e?[e]:e instanceof Array?e:[e]},t.prototype._userInfoFill=function(e){if(null!=e.mobile&&(e.telephone=e.mobile),null!=e.name&&(e.userName=e.name),null!=e.path&&(e.branchName=e.path),null!=e.userUniId&&(e.userId=e.userUniId),null!=e.headerUrl&&(e.photoResId=e.headerUrl,e.photoFileName=e.headerUrl,e.headerUrl=this._resourceFile(e.headerUrl)),(null==e.department||0==e.department.length)&&null!=e.path){var t=e.path,r=t.lastIndexOf("-");r>=0&&(e.department=t.substr(r+1))}return e},t.prototype.getUserInfo=function(e){var t=this,r=[this._userService.UserInfo.userId],n=[],o=[],i=[];null!=e&&("string"==typeof e?r=this._changeToArray(e):(null!=e.userUniId&&(r=this._changeToArray(e.userUniId)),null!=e.mobile&&(n=this._changeToArray(e.mobile)),null!=e.serialNumber&&(o=this._changeToArray(e.serialNumber)),null!=e.extendId&&(i=this._changeToArray(e.extendId))));var u=new s.a;return u.userUniIds=r,u.mobiles=n,u.serialNumbers=o,u.extendIds=i,this._nativeNative.sendMessage(u).then(function(e){var r=e.Message;if(null!=r.result&&1==r.result.length){return t._userInfoFill(r.result[0])}if(null!=r.result&&r.result.length>=2){for(var n=[],o=0;o<r.result.length;o++)n.push(t._userInfoFill(r.result[o]));return n}return null}).catch(function(e){return t._debugService.ShowMessage(JSON.stringify(e)),null})},t.prototype.openFile=function(e){return null!=e.url&&window.open(e.url),Promise.resolve(!0)},t.prototype.downloadFile=function(e){var t=new u.a;return t.external=!0,t.resourceId=e.resourceId,this._nativeNative.sendMessage(t).then(function(e){var t=e.Message;return null!=t.result?{file:t.result.filePath}:null})},t.prototype.uploadBehaviorData=function(e){var t=new c.a;return t.data=e.behavior,this._nativeNative.sendMessage(t).then(function(e){var t=e.Message;return e.Success?Promise.resolve(t.result):Promise.reject(e.Error)})},t.prototype.openFileChoose=function(e){return void 0===e&&(e=null),new Promise(function(t,r){var o=document.createElement("input");o.type="file";var i=1;null!=e&&null!=e.maxCount&&1!=e.maxCount&&(o.multiple=!0,i=e.maxCount),document.body.appendChild(o),o.onchange=function(e){for(var r=[],s=0;s<o.files.length&&s<i;s++){var u=new n.a(null);u.file=o.files[s],u.fileName=o.files[s].name,r[s]=u}var c={};r.length>0&&(c.nativeFile=r[0]),c.nativeFiles=r,t(c),document.body.removeChild(o)},o.click()})},t.prototype.chooseImage=function(e){var t=this;return this.openFileChoose(e).then(function(e){return{nativeFiles:e.nativeFiles}}).catch(function(e){null!=e&&null!=e.message&&t._debugService.ShowMessage(e.message)})},t.prototype.wifiDeviceInfo=function(e){var t={ssid:"测试SSID",bssid:"测试MAC地址"};return Promise.resolve(t)},t.prototype.previewImage=function(e){return Promise.resolve(!1)},t.prototype.openVoiceRecorder=function(e){return this.openFileChoose().then(function(e){return n.a.wrapFileListResult(e,e.urls),e})},t.prototype.openVoicePlayer=function(e){return Promise.resolve(!1)},t.prototype.recordVideo=function(e){var t=this;return this.openFileChoose(e).then(function(e){return{nativeFile:e.nativeFile}}).catch(function(e){null!=e&&null!=e.message&&t._debugService.ShowMessage(e.message)})},t.prototype.openVideo=function(e){return null!=e&&null!=e.url?o.a.DownloadFile(e.url):Promise.resolve(!1)},t.prototype.getLocation=function(e){var t={name:"自动获取的地址",longitude:116.23,latitude:39.54};return Promise.resolve(t)},t.prototype.selectLocation=function(e){return this.openFileChoose()},t.prototype.displayLocation=function(e){return this.openFileChoose()},t.prototype.scanQRCode=function(e){var t={resultStr:"not support on web."};return Promise.resolve(t)},t.prototype.makeCode=function(e){return this.openFileChoose()},t.prototype.handWrite=function(e){return this.openFileChoose()},t.prototype.checkNFC=function(e){var t={nfcId:"示例nfcId",nfcdata:"示例nfcdata"};return Promise.resolve(t)},t.prototype.checkBlueTooth=function(e){return this.openFileChoose()},t.prototype.pickDate=function(e){return this.openFileChoose()},t.prototype.ajax=function(e){return this.openFileChoose()},t.prototype.registerMenu=function(e){return this.openFileChoose()},t.prototype.transferMess=function(e){return this.openFileChoose()},t.prototype.recombineNotify=function(e){return this.openFileChoose()},t.prototype.exploreFile=function(e){return this.openFileChoose()},t.prototype.getAppSetting=function(e){var t=new a.a,r=this._hostInfoService.appId;return null!=e.appId&&(r=e.appId),t.appIdList=[r],this._nativeNative.sendMessage(t).then(function(e){return e.Message.appSettings[r]})},t.prototype.notifyInputEvent=function(e){return this.openFileChoose()},t.prototype.notifySizeChanged=function(e){return this.openFileChoose()},t.prototype.finish=function(e){return this.openFileChoose()},t.prototype.IO=function(e){return this.openFileChoose()},t.prototype.bpLog=function(e){return null!=e&&null!=e.string?(console.log(e.string),Promise.resolve(!0)):Promise.resolve(!1)},t.prototype.call=function(e){return this.openFileChoose()},t.prototype.sendSMS=function(e){return Promise.resolve(!1)},t.prototype.sendWX=function(e){return Promise.resolve(!1)},t.prototype.error=function(e){return this.openFileChoose()},t.prototype.getResourceUrl=function(e){return Promise.resolve(this._resourceFile(e.resourceId))},t.prototype._resourceFile=function(e){return this._hostInfoService.info.webServerUrl+this._resourceFileUrl+"?resourceId="+e},t.prototype.bpCloseWindow=function(e){return window.history.back(),Promise.resolve()},t.prototype.sendMessage=function(e){return this._transferService.send(e.message)},t.prototype.setStatusBar=function(e){return Promise.resolve(!1)},t.prototype.shareMessage=function(e){return Promise.resolve(!1)},t}(l.a)},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(0),o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(e){function t(){var t=e.call(this)||this;return t.OperateCode=3112,t}return o(t,e),t}(n.a)},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(0),o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(e){function t(){var t=e.call(this)||this;return t.OperateCode=6101,t}return o(t,e),t}(n.a)},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(0),o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(e){function t(){var t=e.call(this)||this;return t.OperateCode=2104,t}return o(t,e),t}(n.a)},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=(function(){function e(e){e.register(this,this.name,this.excute)}}(),function(){function e(e){for(var t=Object.getPrototypeOf(this),r=Object.getOwnPropertyNames(t),n=0,o=r;n<o.length;n++){var i=o[n];if((!i.length||"_"!=i[0])&&"constructor"!=i){var s=this[i];"function"==typeof s&&e.register(this,i,s)}}}return e}())},function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=function(){function e(){}return e.prototype.get=function(e){return this.request("GET",e)},e.prototype.request=function(e,t,r){return new Promise(function(n,o){var i=new XMLHttpRequest;i.open(e,t),i.onload=function(){i.status>=200&&i.status<300?n(JSON.parse(i.response)):o({status:i.status,statusText:i.statusText})},i.onerror=function(){o({status:i.status,statusText:i.statusText})},"POST"==e?(i.setRequestHeader("Content-type","application/json"),i.send(JSON.stringify(r))):i.send()})},e.prototype.post=function(e,t){return this.request("POST",e,t)},e}()}])});